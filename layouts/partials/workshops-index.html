<div class="d-flex container flex-wrap">
  <div class="section-index flex-1">
    {{ $pages := (where .Site.Pages "Section" .Section).ByWeight }}
    {{ $parent := .Page }}
    {{ if $parent.Params.no_list }}
      {{/* If no_list is true we don't show a list of subpages */}}
    {{ else if $parent.Params.simple_list }}
      {{/* If simple_list is true we show a bulleted list of subpages */}}
      <ul>
        {{ range $pages }}
          {{ if and (eq .Parent $parent) (not .Params.hidden) }}
            <li><a href="{{ .RelPermalink }}">{{- .Title -}}</a></li>
          {{ end }}
        {{ end }}
      </ul>
    {{ else }}
      {{/* Otherwise we show a nice formatted list of subpages with page descriptions */}}
      <!-- <hr class="panel-line"> -->
      <div class="row">
        {{ range (where .Pages "Params.tags" "intersect" (slice "Tanzu")).ByWeight }}
          {{ if and (eq .Parent $parent) (not .Params.hidden) }}
            {{ $image := (.Params.hero | default (print "/images/workshop/heroes/" (urlize .Params.name) ".jpg") | relURL ) }}
            <div
              class="filter-item col-lg-4 mb-4 flex-315 px-0 mr-lg-3 {{ range .Params.tags }}
                {{ . | lower }}
              {{ end }} "
            >
              <a
                class="linked-box td-box--gray-darkest workshop-box hover-scale overflow-hidden rounded"
                href="{{ .RelPermalink }}"
              >
                <div
                  class="workshop-hero bg-transparent"
                  style="background-image: url({{$image}});background-size:cover;background-position:center"
                ></div>
                <div
                  class="description px-4 pt-2 d-flex flex-column justify-content-between pb-4 bg-gray-dark"
                >
                  <div>
                    <h4 class="workshop-title mt-3">{{- .Title -}}</h4>
                    {{ if gt (len .Description) 100 }}
                      <p class="text-white workshop-text">
                        {{ print (substr .Description 0 100) "..." }}
                      </p>
                    {{ else }}
                      <p class="text-white workshop-text">
                        {{ .Description | markdownify }}
                      </p>
                    {{ end }}
                  </div>
                  <h5 class="fs-80 opacity-4">
                    <span class="fa fa-hourglass-half mr-1">&nbsp;</span
                    >{{ .Params.length }} minutes
                  </h5>
                </div>
              </a>
            </div>
          {{ end }}
        {{ end }}
      </div>
      <hr class="panel-line" />
      <!-- <div class="col"> -->
      <div class="row">
        <!-- Groups content according to the "param_key" field in front matter -->
        {{ range .Pages.GroupByParam "level1" }}
          <!--
          <div class="col">
            -->
          <div class="row">
            <h3>{{ .Key }}</h3>
          </div>
          <div class="carousel slide">
              <div class=" row carousel-inner" role="listbox">
                {{ range $index, $value := .Pages }}
                  {{ if and (eq .Parent $parent) (not .Params.hidden) }}
                    {{ $image := (.Params.hero | default (print "/images/workshop/heroes/" (urlize .Params.name) ".jpg") | relURL ) }}
                    <!-- <div -->
                      <!-- class="carousel-item {{ if eq $index 0 }}active{{ end }}" -->
                    <!-- > -->
                      <div
                        class="filter-item col-lg-4 mb-4 flex-315 px-0 mr-lg-3 {{ range .Params.tags }}
                          {{ . | lower }}
                        {{ end }} "
                      >
                        <a
                          class="linked-box td-box--gray-darkest workshop-box hover-scale overflow-hidden rounded"
                          href="{{ .RelPermalink }}"
                        >
                          <div
                            class="workshop-hero bg-transparent"
                            style="background-image: url({{$image}});background-size:cover;background-position:center"
                          ></div>
                          <div
                            class="description px-4 pt-2 d-flex flex-column justify-content-between pb-4 bg-gray-dark"
                          >
                            <div>
                              <h4 class="workshop-title mt-3">
                                {{- .Title -}}
                              </h4>
                              {{ if gt (len .Description) 100 }}
                                <p class="text-white workshop-text">
                                  {{ print (substr .Description 0 100) "..." }}
                                </p>
                              {{ else }}
                                <p class="text-white workshop-text">
                                  {{ .Description | markdownify }}
                                </p>
                              {{ end }}
                            </div>
                            <h5 class="fs-80 opacity-4">
                              <span class="fa fa-hourglass-half mr-1"
                                >&nbsp;</span
                              >{{ .Params.length }} minutes
                            </h5>
                          </div>
                        </a>
                      </div>
                    <!-- </div> -->
                  {{ end }}
                {{ end }}
              </div>
          </div>
            <!--  </div> -->
          <!-- </div> -->
        {{ end }}
      </div>
    {{ end }}
  </div>
</div>
